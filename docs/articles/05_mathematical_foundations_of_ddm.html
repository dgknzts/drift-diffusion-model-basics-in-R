<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Mathematical Foundations of the DDM • DDM_Basics_R</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mathematical Foundations of the DDM">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DDM_Basics_R</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/shiny_app.html">Interactive Demo</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mathematical Foundations of the DDM</h1>
                        <h4 data-toc-skip class="author">Dogukan Nami
Oztas</h4>
            
            <h4 data-toc-skip class="date">2025-05-19</h4>
      

      <div class="d-none name"><code>05_mathematical_foundations_of_ddm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>While our project primarily focuses on understanding the Diffusion
Decision Model (DDM) through simulation, it’s important to recognize
that the DDM is a formally defined mathematical model. The simulations
we perform are essentially numerical approximations of an underlying
continuous stochastic process. This vignette provides a brief conceptual
overview of these mathematical foundations.</p>
</div>
<div class="section level2">
<h2 id="the-ddm-a-continuous-process-of-evidence-accumulation">The DDM: A Continuous Process of Evidence Accumulation<a class="anchor" aria-label="anchor" href="#the-ddm-a-continuous-process-of-evidence-accumulation"></a>
</h2>
<p>At its heart, the DDM describes how evidence
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>t</mi></msub><annotation encoding="application/x-tex">X_t</annotation></semantics></math>)
for one of two choices accumulates over time
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>).
This accumulation isn’t perfectly steady; it’s influenced by two main
forces:</p>
<ol style="list-style-type: decimal">
<li>A <strong>systematic “pull” or “drift”</strong>: This is the average
direction and speed at which evidence tends to accumulate, represented
by the <strong>drift rate
(</strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>).
A stronger or clearer stimulus generally leads to a higher magnitude of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>.</li>
<li>
<strong>Random “jiggles” or “noise”</strong>: This represents
moment-to-moment fluctuations and inconsistencies in the evidence
gathering or processing, characterized by a <strong>noise standard
deviation
(</strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>).</li>
</ol>
<p>To describe such a continuous process that changes both
systematically and randomly, mathematicians use <strong>Stochastic
Differential Equations (SDEs)</strong>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate with positive drift</span></span>
<span><span class="fu">demonstrate_ddm_components</span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0.1</span>, s <span class="op">=</span> <span class="fl">0.2</span>, n_paths <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="05_mathematical_foundations_of_ddm_files/figure-html/c1-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="understanding-infinitesimal-and-continuous-change">Understanding “Infinitesimal” and Continuous Change<a class="anchor" aria-label="anchor" href="#understanding-infinitesimal-and-continuous-change"></a>
</h3>
<p>Before looking at the SDE, let’s understand the concept of
“infinitesimal.” Imagine trying to describe a smooth, curved path:</p>
<ul>
<li>You could use a few straight line segments connecting distant
points. This would be a rough approximation.</li>
<li>You could use many, many very short line segments. This would look
much smoother and closer to the true curve.</li>
</ul>
<p>“Infinitesimal” takes this idea to the extreme: it refers to changes
or intervals that are <strong>immeasurably or incalculably
small</strong>. By considering these infinitely small steps in time
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dt</annotation></semantics></math>)
and evidence
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">dX_t</annotation></semantics></math>),
calculus and SDEs can precisely describe processes that unfold
continuously and smoothly, even when they involve randomness.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">show_discrete_to_continuous</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="05_mathematical_foundations_of_ddm_files/figure-html/c2-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="the-ddm-as-a-stochastic-differential-equation-sde">The DDM as a Stochastic Differential Equation (SDE)<a class="anchor" aria-label="anchor" href="#the-ddm-as-a-stochastic-differential-equation-sde"></a>
</h3>
<p>The DDM’s evidence accumulation process is formally expressed by the
following SDE:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><mi>v</mi><mo>⋅</mo><mi>d</mi><mi>t</mi><mo>+</mo><mi>s</mi><mo>⋅</mo><mi>d</mi><msub><mi>W</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
dX_t = v \cdot dt + s \cdot dW_t
</annotation></semantics></math></p>
<p>Let’s break this down:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dt</annotation></semantics></math>
(Infinitesimal Time Step): Think of this as an incredibly tiny, almost
zero-length, slice of time.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">dX_t</annotation></semantics></math>
(Infinitesimal Change in Evidence): This is the tiny change in the
accumulated evidence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
that happens <em>during</em> that infinitesimal time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dt</annotation></semantics></math>.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>⋅</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">v \cdot dt</annotation></semantics></math>
(The Drift Component):
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>
is the <strong>drift rate</strong>.</li>
<li>This term represents the predictable, average change in evidence due
to the quality of the stimulus. If there were no noise, the evidence
would change by exactly
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>⋅</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">v \cdot dt</annotation></semantics></math>
during the time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dt</annotation></semantics></math>.</li>
</ul>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>⋅</mo><mi>d</mi><msub><mi>W</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s \cdot dW_t</annotation></semantics></math>
(The Noise/Diffusion Component):
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
is the <strong>noise intensity</strong> (standard deviation of the noise
process).</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>W</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">dW_t</annotation></semantics></math>
is an <strong>infinitesimal increment of a Wiener process</strong> (also
known as Brownian motion). You can think of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>W</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">dW_t</annotation></semantics></math>
as a tiny, random “kick” or “nudge” the evidence receives during
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dt</annotation></semantics></math>.
These kicks are drawn from a Normal distribution with a mean of 0 and a
variance equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dt</annotation></semantics></math>
(so, standard deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mrow><mi>d</mi><mi>t</mi></mrow></msqrt><annotation encoding="application/x-tex">\sqrt{dt}</annotation></semantics></math>).
The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
parameter scales the size of these random kicks.</li>
</ul>
</li>
</ul>
<p>So, the equation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><mi>v</mi><mo>⋅</mo><mi>d</mi><mi>t</mi><mo>+</mo><mi>s</mi><mo>⋅</mo><mi>d</mi><msub><mi>W</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">dX_t = v \cdot dt + s \cdot dW_t</annotation></semantics></math>
means: “In an infinitesimally small moment of time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dt</annotation></semantics></math>,
the tiny change in evidence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">dX_t</annotation></semantics></math>
is the sum of a systematic change due to drift
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>⋅</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">v \cdot dt</annotation></semantics></math>)
and a random change due to noise
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>⋅</mo><mi>d</mi><msub><mi>W</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s \cdot dW_t</annotation></semantics></math>).”</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">visualize_sde_components</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="05_mathematical_foundations_of_ddm_files/figure-html/c3-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">explore_choice_probability</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="05_mathematical_foundations_of_ddm_files/figure-html/c4-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="connecting-the-sde-to-our-simulations-euler-maruyama">Connecting the SDE to Our Simulations (Euler-Maruyama)<a class="anchor" aria-label="anchor" href="#connecting-the-sde-to-our-simulations-euler-maruyama"></a>
</h3>
<p>Computers can’t work with true “infinitesimals.” Instead, our
simulation functions (like <code>simulate_diffusion_trial</code>) use a
<strong>small, finite time step</strong>, which we call <code>dt</code>
in our code (e.g., <code>0.001</code> seconds). This method of
approximating an SDE with small, discrete steps is known as the
<strong>Euler-Maruyama method</strong>.</p>
<p>For each small time step <code>dt</code> in our simulation, the
change in evidence
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\Delta X_t</annotation></semantics></math>)
is calculated as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msub><mi>X</mi><mi>t</mi></msub><mo>≈</mo><mi>v</mi><mo>⋅</mo><msub><mtext mathvariant="normal">dt</mtext><mtext mathvariant="normal">sim</mtext></msub><mo>+</mo><mi>s</mi><mo>⋅</mo><msqrt><msub><mtext mathvariant="normal">dt</mtext><mtext mathvariant="normal">sim</mtext></msub></msqrt><mo>⋅</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">
\Delta X_t \approx v \cdot \text{dt}_{\text{sim}} + s \cdot \sqrt{\text{dt}_{\text{sim}}} \cdot Z
</annotation></semantics></math></p>
<p>where: *
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">dt</mtext><mtext mathvariant="normal">sim</mtext></msub><annotation encoding="application/x-tex">\text{dt}_{\text{sim}}</annotation></semantics></math>
is our simulation’s time step parameter. *
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
is a random number drawn from a standard Normal distribution (mean 0,
standard deviation 1).</p>
<p>This simulated increment
<code>rnorm(1, mean = v_trial * dt, sd = s * sqrt(dt))</code> directly
implements this Euler-Maruyama step. The smaller we make our simulation
<code>dt</code>, the closer our simulated paths get to the true
continuous process described by the SDE. It’s like using more and more
tiny line segments to draw a smooth curve.</p>
</div>
</div>
<div class="section level2">
<h2 id="first-passage-times-and-choice-probabilities">First Passage Times and Choice Probabilities<a class="anchor" aria-label="anchor" href="#first-passage-times-and-choice-probabilities"></a>
</h2>
<p>The core predictions of the DDM concern two main outcomes:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Choice:</strong> Which of the two decision boundaries (e.g.,
an upper boundary
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
or a lower boundary
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>)
is the accumulating evidence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>t</mi></msub><annotation encoding="application/x-tex">X_t</annotation></semantics></math>
going to hit first?</li>
<li>
<strong>Reaction Time (RT):</strong> How long does it take for the
evidence to reach one of these boundaries? In mathematical terms, this
is known as a “first passage time” – the time it takes for the process
to first cross a specific threshold.</li>
</ol>
<p>For the <strong>simple DDM</strong>, where the parameters
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>z</code> (starting point), and <code>s</code> (noise intensity)
are all constant across trials, mathematicians like William Feller have
derived <strong>analytical solutions</strong>.</p>
<p><strong>What is an Analytical Solution?</strong></p>
<p>An analytical solution is a precise mathematical formula that
directly calculates a model’s prediction (like a choice probability or
the shape of the RT distribution) from its parameters. This is different
from a simulation, which <em>approximates</em> these predictions by
running many random trials. Analytical solutions are exact and
computationally efficient when available.</p>
<p>These solutions often come from solving the differential equations
(like the Kolmogorov equations) associated with the stochastic process
defined by the DDM. Feller’s work provided many foundational results for
such diffusion processes.</p>
<div class="section level3">
<h3 id="analytical-solution-for-choice-probability">Analytical Solution for Choice Probability<a class="anchor" aria-label="anchor" href="#analytical-solution-for-choice-probability"></a>
</h3>
<p>One such key analytical result, derived from the theory of diffusion
processes (see Feller, 1968, Vol II, Ch. XIV), gives us the probability
that the evidence accumulation process, starting at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
with boundaries at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>,
will hit the upper boundary
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
before hitting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>.</p>
<p>For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">v \neq 0</annotation></semantics></math>,
this probability is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mtext mathvariant="normal">hit upper </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mi>−</mi><mn>2</mn><mi>v</mi><mi>z</mi><mi>/</mi><msup><mi>s</mi><mn>2</mn></msup></mrow></msup></mrow><mrow><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mi>−</mi><mn>2</mn><mi>v</mi><mi>a</mi><mi>/</mi><msup><mi>s</mi><mn>2</mn></msup></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
P(\text{hit upper } a) = \frac{1 - e^{-2vz/s^2}}{1 - e^{-2va/s^2}}
</annotation></semantics></math></p>
<p>And if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">v = 0</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mtext mathvariant="normal">hit upper </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>z</mi><mi>a</mi></mfrac></mrow><annotation encoding="application/x-tex">
P(\text{hit upper } a) = \frac{z}{a}
</annotation></semantics></math></p>
<p>We can implement this formula in R and compare its predictions to
those from our DDM simulator (the version <em>without</em> across-trial
parameter variability, found in
<code>R/02_ddm_simulator_basic.R</code>). This comparison serves as an
important validation of our simulation code.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analytical_p_upper</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span>, <span class="va">a</span>, <span class="va">z</span>, <span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">a</span> <span class="op">&lt;=</span> <span class="fl">0</span> <span class="op">||</span> <span class="va">z</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">||</span> <span class="va">z</span> <span class="op">&gt;</span> <span class="va">a</span> <span class="op">||</span> <span class="va">s</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span> <span class="co"># Basic validation</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Invalid parameters for analytical_p_upper."</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-9</span><span class="op">)</span> <span class="op">{</span> <span class="co"># Treat v as effectively zero</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">z</span> <span class="op">/</span> <span class="va">a</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># Using s directly as in dX = v*dt + s*dW, so s^2 is variance rate parameter</span></span>
<span>    <span class="va">numerator</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="va">v</span> <span class="op">*</span> <span class="va">z</span> <span class="op">/</span> <span class="op">(</span><span class="va">s</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">denominator</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="va">v</span> <span class="op">*</span> <span class="va">a</span> <span class="op">/</span> <span class="op">(</span><span class="va">s</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">denominator</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-9</span><span class="op">)</span> <span class="op">{</span> <span class="co"># Avoid division by zero if exp terms are ~1</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Denominator close to zero in analytical_p_upper; parameters might be extreme."</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span> </span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">numerator</span> <span class="op">/</span> <span class="va">denominator</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparing-analytical-solution-with-simulation">Comparing Analytical Solution with Simulation<a class="anchor" aria-label="anchor" href="#comparing-analytical-solution-with-simulation"></a>
</h3>
<p>Let’s pick a set of parameters and see how our simulation results for
P(choice=1) compare to the analytical solution.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parameters for comparison</span></span>
<span><span class="va">comp_params_math</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  v <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  a <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  z <span class="op">=</span> <span class="fl">0.35</span>, <span class="co"># Unbiased start</span></span>
<span>  s <span class="op">=</span> <span class="fl">0.2</span>, <span class="co"># Standard DDM scaling parameter for s</span></span>
<span>  ter <span class="op">=</span> <span class="fl">0</span>, <span class="co"># Not relevant for choice probability, set to 0 for this sim</span></span>
<span>  dt <span class="op">=</span> <span class="fl">0.001</span></span>
<span><span class="op">)</span></span>
<span><span class="va">n_sim_math_comp</span> <span class="op">&lt;-</span> <span class="fl">2000</span> <span class="co"># Use a large number of trials for stable estimate</span></span>
<span></span>
<span><span class="co"># Analytical Prediction</span></span>
<span><span class="va">p_upper_analytical_val</span> <span class="op">&lt;-</span> <span class="fu">analytical_p_upper</span><span class="op">(</span></span>
<span>  v <span class="op">=</span> <span class="va">comp_params_math</span><span class="op">$</span><span class="va">v</span>, a <span class="op">=</span> <span class="va">comp_params_math</span><span class="op">$</span><span class="va">a</span>, </span>
<span>  z <span class="op">=</span> <span class="va">comp_params_math</span><span class="op">$</span><span class="va">z</span>, s <span class="op">=</span> <span class="va">comp_params_math</span><span class="op">$</span><span class="va">s</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Analytical P(hit upper boundary 'a'):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p_upper_analytical_val</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Analytical P(hit upper boundary 'a'): 0.85195</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulation (using simulate_diffusion_experiment from 02_ddm_simulator_basic.R)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span> </span>
<span><span class="va">sim_data_math_comp</span> <span class="op">&lt;-</span> <span class="fu">simulate_diffusion_experiment</span><span class="op">(</span> </span>
<span>  n_trials <span class="op">=</span> <span class="va">n_sim_math_comp</span>,</span>
<span>  v <span class="op">=</span> <span class="va">comp_params_math</span><span class="op">$</span><span class="va">v</span>,</span>
<span>  a <span class="op">=</span> <span class="va">comp_params_math</span><span class="op">$</span><span class="va">a</span>,</span>
<span>  z <span class="op">=</span> <span class="va">comp_params_math</span><span class="op">$</span><span class="va">z</span>,</span>
<span>  s <span class="op">=</span> <span class="va">comp_params_math</span><span class="op">$</span><span class="va">s</span>,</span>
<span>  ter <span class="op">=</span> <span class="va">comp_params_math</span><span class="op">$</span><span class="va">ter</span>,</span>
<span>  dt <span class="op">=</span> <span class="va">comp_params_math</span><span class="op">$</span><span class="va">dt</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_upper_simulated_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim_data_math_comp</span><span class="op">$</span><span class="va">choice</span> <span class="op">==</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Simulated P(hit upper boundary 'a') from"</span>, <span class="va">n_sim_math_comp</span>, <span class="st">"trials:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p_upper_simulated_val</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simulated P(hit upper boundary 'a') from 2000 trials: 0.85179</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Absolute difference:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p_upper_analytical_val</span> <span class="op">-</span> <span class="va">p_upper_simulated_val</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Absolute difference: 0.00016</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Comprehensive comparison of analytical vs simulated</span></span>
<span><span class="va">verify_analytical_solution</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_sims</span> <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Test parameters</span></span>
<span>  <span class="va">test_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>    v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>    z_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">test_params</span><span class="op">$</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span>  <span class="va">test_params</span><span class="op">$</span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">test_params</span><span class="op">$</span><span class="va">z_ratio</span> <span class="op">*</span> <span class="va">test_params</span><span class="op">$</span><span class="va">a</span></span>
<span>  <span class="va">test_params</span><span class="op">$</span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span>  </span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">test_params</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">params</span> <span class="op">&lt;-</span> <span class="va">test_params</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># Analytical prediction</span></span>
<span>    <span class="va">p_analytical</span> <span class="op">&lt;-</span> <span class="fu">analytical_p_upper</span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">v</span>, <span class="va">params</span><span class="op">$</span><span class="va">a</span>, <span class="va">params</span><span class="op">$</span><span class="va">z</span>, <span class="va">params</span><span class="op">$</span><span class="va">s</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Simulation</span></span>
<span>    <span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu">simulate_diffusion_experiment</span><span class="op">(</span></span>
<span>      n_trials <span class="op">=</span> <span class="va">n_sims</span>,</span>
<span>      v <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">v</span>,</span>
<span>      a <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">a</span>,</span>
<span>      z <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">z</span>,</span>
<span>      s <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">s</span>,</span>
<span>      ter <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      dt <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>      verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">p_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">choice</span> <span class="op">==</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">se_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p_simulated</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_simulated</span><span class="op">)</span> <span class="op">/</span> <span class="va">n_sims</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">results</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      v <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">v</span>,</span>
<span>      z_ratio <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">z_ratio</span>,</span>
<span>      p_analytical <span class="op">=</span> <span class="va">p_analytical</span>,</span>
<span>      p_simulated <span class="op">=</span> <span class="va">p_simulated</span>,</span>
<span>      se_simulated <span class="op">=</span> <span class="va">se_simulated</span>,</span>
<span>      difference <span class="op">=</span> <span class="va">p_simulated</span> <span class="op">-</span> <span class="va">p_analytical</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Visualization</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">results</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">p_analytical</span>, y <span class="op">=</span> <span class="va">p_simulated</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">p_simulated</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">se_simulated</span>, </span>
<span>                     ymax <span class="op">=</span> <span class="va">p_simulated</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">se_simulated</span><span class="op">)</span>, </span>
<span>                 width <span class="op">=</span> <span class="fl">0.01</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_viridis_d</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Drift (v)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Analytical vs Simulated Choice Probabilities"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Analytical P(upper)"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Simulated P(upper)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">coord_equal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">results</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">v</span>, <span class="va">z_ratio</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">difference</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">difference</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">se_simulated</span>, </span>
<span>                     ymax <span class="op">=</span> <span class="va">difference</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">se_simulated</span><span class="op">)</span>, </span>
<span>                 width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Difference: Simulated - Analytical"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Condition (v, z/a)"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Difference"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Summary Statistics:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Mean absolute difference: %.5f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">difference</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Max absolute difference: %.5f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">difference</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"All differences within 2 SE: %s\n"</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">difference</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">*</span><span class="va">results</span><span class="op">$</span><span class="va">se_simulated</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">verify_analytical_solution</span><span class="op">(</span>n_sims <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="05_mathematical_foundations_of_ddm_files/figure-html/unnamed-chunk-1-1.png" width="700" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">## Summary Statistics:</span></span>
<span><span class="co">## Mean absolute difference: 0.01565</span></span>
<span><span class="co">## Max absolute difference: 0.04048</span></span>
<span><span class="co">## All differences within 2 SE: FALSE</span></span></code></pre>
<p><em>Observation:</em> The simulated proportion of choices for the
upper boundary should be very close to the analytically derived
probability. Any small difference is due to the stochastic nature of the
simulation and the finite number of trials. Increasing
<code>n_sim_math_comp</code> would typically reduce this difference.
This comparison provides a good validation for our basic DDM simulation
logic.</p>
</div>
<div class="section level3">
<h3 id="analytical-solutions-for-rt-distributions">Analytical Solutions for RT Distributions<a class="anchor" aria-label="anchor" href="#analytical-solutions-for-rt-distributions"></a>
</h3>
<p>Analytical solutions also exist for the <em>entire distribution</em>
of first passage times (RTs) for the simple DDM. These are often
expressed as an infinite sum of terms involving exponential and
trigonometric functions (e.g., see Ratcliff, 1978, Appendix; Feller,
1968; Cox &amp; Miller, 1965).</p>
<p>For example, the probability density function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(t)</annotation></semantics></math>
for hitting the upper boundary
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
starting at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>,
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">v, a, z, s</annotation></semantics></math>
(where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
is the noise SD parameter as in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><mi>v</mi><mi>d</mi><mi>t</mi><mo>+</mo><mi>s</mi><mi>d</mi><msub><mi>W</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">dX_t = v dt + s dW_t</annotation></semantics></math>)
can be written as (e.g., Navarro &amp; Fuss, 2009, adapting Feller):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><mi>v</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>π</mi><msup><mi>s</mi><mn>2</mn></msup></mrow><msup><mi>a</mi><mn>2</mn></msup></mfrac><msup><mi>e</mi><mrow><mi>−</mi><mfrac><mrow><mi>v</mi><mi>z</mi></mrow><msup><mi>s</mi><mn>2</mn></msup></mfrac><mo>−</mo><mfrac><mrow><msup><mi>v</mi><mn>2</mn></msup><mi>t</mi></mrow><mrow><mn>2</mn><msup><mi>s</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">∞</mo></munderover><mi>k</mi><mo>sin</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>k</mi><mi>π</mi><mi>z</mi></mrow><mi>a</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>e</mi><mrow><mi>−</mi><mfrac><mrow><msup><mi>k</mi><mn>2</mn></msup><msup><mi>π</mi><mn>2</mn></msup><msup><mi>s</mi><mn>2</mn></msup><mi>t</mi></mrow><mrow><mn>2</mn><msup><mi>a</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup></mrow><annotation encoding="application/x-tex">
g(t|v,a,z,s) = \frac{\pi s^2}{a^2} e^{-\frac{vz}{s^2} - \frac{v^2 t}{2s^2}} \sum_{k=1}^{\infty} k \sin\left(\frac{k\pi z}{a}\right) e^{-\frac{k^2\pi^2s^2t}{2a^2}}
</annotation></semantics></math></p>
<p>Implementing and accurately evaluating such infinite series can be
numerically challenging (requiring careful truncation of the series and
handling of potential underflow/overflow). This is one reason why direct
simulation is often a practical and powerful approach, especially when
across-trial parameter variabilities are introduced, as these often
render analytical solutions intractable.</p>
</div>
</div>
<div class="section level2">
<h2 id="why-simulation-is-powerful">Why Simulation is Powerful<a class="anchor" aria-label="anchor" href="#why-simulation-is-powerful"></a>
</h2>
<ul>
<li>
<strong>Complexity:</strong> When across-trial variabilities
(<code>sv</code>, <code>sz</code>, <code>st0</code>) are added to the
DDM, or if more complex model features (e.g., collapsing boundaries,
urgency signals, inter-trial dependencies) are included, deriving full
analytical solutions for choice probabilities and RT distributions
becomes extremely difficult or practically impossible.</li>
<li>
<strong>Flexibility:</strong> Simulation allows us to explore these
complex models by directly implementing the proposed generative process,
step by step.</li>
<li>
<strong>Intuition:</strong> Simulating individual trials (as
demonstrated with path visualizations in other vignettes) provides
strong intuition about how the model behaves under different parameter
configurations.</li>
</ul>
<p>Our project leverages this power of simulation to understand the DDM,
including its more complex variants with parameter variability, which
are essential for modeling real-world behavioral data.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The Diffusion Decision Model is grounded in well-defined mathematics,
typically expressed as a stochastic differential equation that describes
the noisy accumulation of evidence. For simpler versions of the model
(without across-trial parameter variability), analytical solutions for
key predictions like choice probabilities and RT distributions can be
derived.</p>
<p>Our simulation approach, based on the Euler-Maruyama method, provides
a numerical approximation to this underlying continuous process. The
close match we observed between our basic simulator’s output for choice
probability and the established analytical prediction serves as a good
validation of our core simulation logic.</p>
<p>For more complex and realistic DDM variants, especially those
incorporating across-trial parameter variability, direct analytical
solutions are often not available. This highlights the crucial and
indispensable role of computational simulation methods in exploring,
understanding, and applying these richer models to cognitive
phenomena.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dogukan Nami Oztas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
