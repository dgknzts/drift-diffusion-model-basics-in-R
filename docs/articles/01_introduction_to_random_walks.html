<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to Random Walks in R ‚Ä¢ DDM_Basics_R</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Random Walks in R">
<meta name="description" content="Learn the basics of random walks and their implementation in R">
<meta property="og:description" content="Learn the basics of random walks and their implementation in R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DDM_Basics_R</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/shiny_app.html">Interactive Demo</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to Random Walks in R</h1>
                        <h4 data-toc-skip class="author">Dogukan Nami
Oztas</h4>
            
            <h4 data-toc-skip class="date">2025-05-16</h4>
      

      <div class="d-none name"><code>01_introduction_to_random_walks.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="what-is-a-random-walk">What is a Random Walk?<a class="anchor" aria-label="anchor" href="#what-is-a-random-walk"></a>
</h2>
<p>A <strong>random walk</strong> is a mathematical object, known as a
stochastic or random process, that describes a path consisting of a
succession of random steps. In our context, we‚Äôll focus on
<strong>one-dimensional random walks</strong> where a particle
(representing evidence) moves along a line, taking random steps at each
time point.</p>
<div class="section level3">
<h3 id="mathematical-foundation">Mathematical Foundation<a class="anchor" aria-label="anchor" href="#mathematical-foundation"></a>
</h3>
<p>The discrete-time random walk model can be mathematically expressed
as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>E</mi><mi>t</mi></msub><mo>+</mo><mi>Œº</mi><mo>+</mo><msub><mi>œµ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">E_{t+1} = E_t + \mu + \epsilon_t</annotation></semantics></math></p>
<p>where: -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>t</mi></msub><annotation encoding="application/x-tex">E_t</annotation></semantics></math>
is the evidence at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
-
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is the <strong>drift</strong> (average step size per time unit) -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œµ</mi><mi>t</mi></msub><mo>‚àº</mo><mi>ùí©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>œÉ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\epsilon_t \sim \mathcal{N}(0, \sigma^2)</annotation></semantics></math>
is random noise (Gaussian white noise)</p>
<p>The process continues until the evidence crosses one of two decision
boundaries: - <strong>Upper threshold</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>t</mi></msub><mo>‚â•</mo><mi>+</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">E_t \geq +a</annotation></semantics></math>
‚Üí Decision ‚ÄúA‚Äù (choice = 1) - <strong>Lower threshold</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>t</mi></msub><mo>‚â§</mo><mi>‚àí</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">E_t \leq -a</annotation></semantics></math>
‚Üí Decision ‚ÄúB‚Äù (choice = -1)</p>
</div>
<div class="section level3">
<h3 id="connection-to-decision-making">Connection to Decision Making<a class="anchor" aria-label="anchor" href="#connection-to-decision-making"></a>
</h3>
<p>Random walks are fundamental to understanding <strong>decision-making
models</strong>, particularly the <strong>Diffusion Decision Model
(DDM)</strong>. In psychological terms:</p>
<ul>
<li>
<strong>Evidence accumulation</strong>: Information gradually builds
up over time</li>
<li>
<strong>Decision thresholds</strong>: The amount of evidence needed
to make a decision</li>
<li>
<strong>Drift</strong>: Bias toward one option over another</li>
<li>
<strong>Noise</strong>: Uncertainty and variability in the decision
process</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="simulating-a-single-random-walk-trial">Simulating a Single Random Walk Trial<a class="anchor" aria-label="anchor" href="#simulating-a-single-random-walk-trial"></a>
</h2>
<p>Let‚Äôs start by understanding how a single decision unfolds. We‚Äôll use
the <code>simulate_random_walk_trial()</code> function to simulate
individual trials and visualize the evidence accumulation process.</p>
<div class="section level3">
<h3 id="basic-single-trial-simulation">Basic Single Trial Simulation<a class="anchor" aria-label="anchor" href="#basic-single-trial-simulation"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># For reproducibility</span></span>
<span></span>
<span><span class="co"># Example 1: Positive drift (bias toward upper threshold)</span></span>
<span><span class="va">trial1</span> <span class="op">&lt;-</span> <span class="fu">simulate_random_walk_trial</span><span class="op">(</span>drift <span class="op">=</span> <span class="fl">0.2</span>, threshold <span class="op">=</span> <span class="fl">5</span>, sd_step <span class="op">=</span> <span class="fl">1</span>, return_path <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Trial 1 (positive drift):\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Trial 1 (positive drift):</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Choice ="</span>, <span class="va">trial1</span><span class="op">$</span><span class="va">choice</span>, <span class="st">", RT (steps) ="</span>, <span class="va">trial1</span><span class="op">$</span><span class="va">rt</span>, <span class="st">"\n\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Choice = 1 , RT (steps) = 13</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example 2: Negative drift (bias toward lower threshold)</span></span>
<span><span class="va">trial2</span> <span class="op">&lt;-</span> <span class="fu">simulate_random_walk_trial</span><span class="op">(</span>drift <span class="op">=</span> <span class="op">-</span><span class="fl">0.15</span>, threshold <span class="op">=</span> <span class="fl">5</span>, sd_step <span class="op">=</span> <span class="fl">1</span>, return_path <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Trial 2 (negative drift):\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Trial 2 (negative drift):</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Choice ="</span>, <span class="va">trial2</span><span class="op">$</span><span class="va">choice</span>, <span class="st">", RT (steps) ="</span>, <span class="va">trial2</span><span class="op">$</span><span class="va">rt</span>, <span class="st">"\n\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Choice = -1 , RT (steps) = 12</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example 3: No drift (unbiased)</span></span>
<span><span class="va">trial3</span> <span class="op">&lt;-</span> <span class="fu">simulate_random_walk_trial</span><span class="op">(</span>drift <span class="op">=</span> <span class="fl">0</span>, threshold <span class="op">=</span> <span class="fl">5</span>, sd_step <span class="op">=</span> <span class="fl">1</span>, return_path <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Trial 3 (no drift):\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Trial 3 (no drift):</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Choice ="</span>, <span class="va">trial3</span><span class="op">$</span><span class="va">choice</span>, <span class="st">", RT (steps) ="</span>, <span class="va">trial3</span><span class="op">$</span><span class="va">rt</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Choice = 1 , RT (steps) = 31</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="visualizing-evidence-accumulation-paths">Visualizing Evidence Accumulation Paths<a class="anchor" aria-label="anchor" href="#visualizing-evidence-accumulation-paths"></a>
</h3>
<p>The power of the random walk model becomes clear when we visualize
how evidence accumulates over time:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create plots for the three trials</span></span>
<span><span class="va">plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Trial 1: Positive drift</span></span>
<span><span class="va">plot_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">{</span></span>
<span>  <span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">trial1</span><span class="op">$</span><span class="va">evidence_path</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    evidence <span class="op">=</span> <span class="va">trial1</span><span class="op">$</span><span class="va">evidence_path</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">df1</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">evidence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, color <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span>, <span class="op">]</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Trial 1: Positive Drift (Œº = 0.2)"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Choice:"</span>, <span class="va">trial1</span><span class="op">$</span><span class="va">choice</span>, <span class="st">"| RT:"</span>, <span class="va">trial1</span><span class="op">$</span><span class="va">rt</span>, <span class="st">"steps"</span><span class="op">)</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Time Steps"</span>, y <span class="op">=</span> <span class="st">"Evidence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylim</span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.1</span>, y <span class="op">=</span> <span class="fl">5.5</span>, label <span class="op">=</span> <span class="st">"Upper Threshold"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.1</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">5.5</span>, label <span class="op">=</span> <span class="st">"Lower Threshold"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">xlim</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Trial 2: Negative drift</span></span>
<span><span class="va">plot_list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">{</span></span>
<span>  <span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">trial2</span><span class="op">$</span><span class="va">evidence_path</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    evidence <span class="op">=</span> <span class="va">trial2</span><span class="op">$</span><span class="va">evidence_path</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">df2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">evidence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"darkgreen"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, color <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span>, <span class="op">]</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Trial 2: Negative Drift (Œº = -0.15)"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Choice:"</span>, <span class="va">trial2</span><span class="op">$</span><span class="va">choice</span>, <span class="st">"| RT:"</span>, <span class="va">trial2</span><span class="op">$</span><span class="va">rt</span>, <span class="st">"steps"</span><span class="op">)</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Time Steps"</span>, y <span class="op">=</span> <span class="st">"Evidence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylim</span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">xlim</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Trial 3: No drift</span></span>
<span><span class="va">plot_list</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">{</span></span>
<span>  <span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">trial3</span><span class="op">$</span><span class="va">evidence_path</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    evidence <span class="op">=</span> <span class="va">trial3</span><span class="op">$</span><span class="va">evidence_path</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">df3</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">evidence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"purple"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, color <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df3</span><span class="op">)</span>, <span class="op">]</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Trial 3: No Drift (Œº = 0)"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Choice:"</span>, <span class="va">trial3</span><span class="op">$</span><span class="va">choice</span>, <span class="st">"| RT:"</span>, <span class="va">trial3</span><span class="op">$</span><span class="va">rt</span>, <span class="st">"steps"</span><span class="op">)</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Time Steps"</span>, y <span class="op">=</span> <span class="st">"Evidence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylim</span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">xlim</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Arrange plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">grid.arrange</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">plot_list</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="01_introduction_to_random_walks_files/figure-html/visualize_paths-1.png" width="768" style="display: block; margin: auto;"></p>
<p><strong>Key Observations:</strong> - <strong>Positive drift</strong>
tends to push evidence toward the upper threshold - <strong>Negative
drift</strong> tends to push evidence toward the lower threshold<br>
- <strong>No drift</strong> creates a symmetric random walk where either
outcome is equally likely - The <strong>red dot</strong> shows where the
threshold was crossed - <strong>Noise</strong> creates the zigzag
pattern in the evidence accumulation</p>
</div>
</div>
<div class="section level2">
<h2 id="exploring-parameter-effects">Exploring Parameter Effects<a class="anchor" aria-label="anchor" href="#exploring-parameter-effects"></a>
</h2>
<p>Let‚Äôs explore how different parameters affect the random walk
behavior:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate multiple trials with different parameters</span></span>
<span><span class="va">param_trials</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  low_noise <span class="op">=</span> <span class="fu">simulate_random_walk_trial</span><span class="op">(</span>drift <span class="op">=</span> <span class="fl">0.1</span>, threshold <span class="op">=</span> <span class="fl">5</span>, sd_step <span class="op">=</span> <span class="fl">0.5</span>, return_path <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  high_noise <span class="op">=</span> <span class="fu">simulate_random_walk_trial</span><span class="op">(</span>drift <span class="op">=</span> <span class="fl">0.1</span>, threshold <span class="op">=</span> <span class="fl">5</span>, sd_step <span class="op">=</span> <span class="fl">2</span>, return_path <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  low_threshold <span class="op">=</span> <span class="fu">simulate_random_walk_trial</span><span class="op">(</span>drift <span class="op">=</span> <span class="fl">0.1</span>, threshold <span class="op">=</span> <span class="fl">2</span>, sd_step <span class="op">=</span> <span class="fl">1</span>, return_path <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  high_threshold <span class="op">=</span> <span class="fu">simulate_random_walk_trial</span><span class="op">(</span>drift <span class="op">=</span> <span class="fl">0.1</span>, threshold <span class="op">=</span> <span class="fl">8</span>, sd_step <span class="op">=</span> <span class="fl">1</span>, return_path <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create comparison plots</span></span>
<span><span class="va">param_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">param_trials</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">trial_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">param_trials</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">trial_data</span> <span class="op">&lt;-</span> <span class="va">param_trials</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">trial_data</span><span class="op">$</span><span class="va">evidence_path</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    evidence <span class="op">=</span> <span class="va">trial_data</span><span class="op">$</span><span class="va">evidence_path</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Determine threshold value for plotting</span></span>
<span>  <span class="va">threshold_val</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">trial_name</span>,</span>
<span>                         <span class="st">"low_threshold"</span> <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                         <span class="st">"high_threshold"</span> <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                         <span class="fl">5</span><span class="op">)</span>  <span class="co"># default</span></span>
<span>  </span>
<span>  <span class="va">param_plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df_temp</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">evidence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">threshold_val</span>, <span class="va">threshold_val</span><span class="op">)</span>, </span>
<span>               linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, color <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_temp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_temp</span><span class="op">)</span>, <span class="op">]</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">trial_name</span>,</span>
<span>                       <span class="st">"low_noise"</span> <span class="op">=</span> <span class="st">"Low Noise (œÉ = 0.5)"</span>,</span>
<span>                       <span class="st">"high_noise"</span> <span class="op">=</span> <span class="st">"High Noise (œÉ = 2.0)"</span>, </span>
<span>                       <span class="st">"low_threshold"</span> <span class="op">=</span> <span class="st">"Low Threshold (a = 2)"</span>,</span>
<span>                       <span class="st">"high_threshold"</span> <span class="op">=</span> <span class="st">"High Threshold (a = 8)"</span><span class="op">)</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Choice:"</span>, <span class="va">trial_data</span><span class="op">$</span><span class="va">choice</span>, <span class="st">"| RT:"</span>, <span class="va">trial_data</span><span class="op">$</span><span class="va">rt</span>, <span class="st">"steps"</span><span class="op">)</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Time Steps"</span>, y <span class="op">=</span> <span class="st">"Evidence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylim</span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">xlim</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">grid.arrange</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">param_plots</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="01_introduction_to_random_walks_files/figure-html/parameter_exploration-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="simulating-a-random-walk-experiment">Simulating a Random Walk Experiment<a class="anchor" aria-label="anchor" href="#simulating-a-random-walk-experiment"></a>
</h2>
<p>To understand the statistical properties of the random walk model, we
need to simulate many trials. Let‚Äôs conduct a comprehensive
experiment:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span><span class="va">n_sim_trials</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Simulate experiment with moderate parameters</span></span>
<span><span class="va">rw_data</span> <span class="op">&lt;-</span> <span class="fu">simulate_random_walk_experiment</span><span class="op">(</span></span>
<span>  n_trials <span class="op">=</span> <span class="va">n_sim_trials</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  drift <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># Slight positive drift</span></span>
<span>  sd_step <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  show_progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display basic statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Experiment Summary:\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Experiment Summary:</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total trials simulated:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">rw_data</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Total trials simulated: 1000</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Trials with valid decisions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rw_data</span><span class="op">$</span><span class="va">choice</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Trials with valid decisions: 1000</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Proportion of valid decisions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rw_data</span><span class="op">$</span><span class="va">choice</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Proportion of valid decisions: 1</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the first few rows</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rw_data</span><span class="op">)</span>, </span>
<span>             caption <span class="op">=</span> <span class="st">"First 6 trials of the simulated random walk experiment."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>First 6 trials of the simulated random walk
experiment.</caption>
<thead><tr class="header">
<th align="right">trial</th>
<th align="right">choice</th>
<th align="right">rt</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">-1</td>
<td align="right">136</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">-1</td>
<td align="right">60</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">68</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">1</td>
<td align="right">24</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="analyzing-experiment-results">Analyzing Experiment Results<a class="anchor" aria-label="anchor" href="#analyzing-experiment-results"></a>
</h3>
<div class="section level4">
<h4 id="choice-proportions-and-accuracy">
<strong>1. Choice Proportions and Accuracy</strong><a class="anchor" aria-label="anchor" href="#choice-proportions-and-accuracy"></a>
</h4>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter out NA choices and create summary</span></span>
<span><span class="va">valid_choices</span> <span class="op">&lt;-</span> <span class="va">rw_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">choice</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>choice_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">choice</span>, </span>
<span>                              levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                              labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lower Threshold (-1)"</span>, <span class="st">"Upper Threshold (1)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">valid_choices</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Calculate choice proportions</span></span>
<span>  <span class="va">choice_summary</span> <span class="op">&lt;-</span> <span class="va">valid_choices</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">count</span><span class="op">(</span><span class="va">choice_label</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>proportion <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Create summary table</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">choice_summary</span> <span class="op">%&gt;%</span> </span>
<span>               <span class="fu">select</span><span class="op">(</span><span class="va">choice_label</span>, <span class="va">n</span>, <span class="va">proportion</span><span class="op">)</span>, </span>
<span>               col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Choice Outcome"</span>, <span class="st">"Count (N)"</span>, <span class="st">"Proportion"</span><span class="op">)</span>,</span>
<span>               caption <span class="op">=</span> <span class="st">"Summary of Choice Proportions"</span>, </span>
<span>               digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Create visualization</span></span>
<span>  <span class="va">p_choice</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">choice_summary</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">choice_label</span>, y <span class="op">=</span> <span class="va">proportion</span>, fill <span class="op">=</span> <span class="va">choice_label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">percent</span><span class="op">(</span><span class="va">proportion</span>, accuracy <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>              vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.3</span>, size <span class="op">=</span> <span class="fl">4</span>, fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">percent_format</span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>                      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">choice_summary</span><span class="op">$</span><span class="va">proportion</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tomato"</span>, <span class="st">"lightblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Choice Proportions in Random Walk Experiment"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"n ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">valid_choices</span><span class="op">)</span>, <span class="st">"trials with positive drift (Œº = 0.05)"</span><span class="op">)</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Decision Outcome"</span>, y <span class="op">=</span> <span class="st">"Proportion of Trials"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_choice</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Statistical test for bias</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">valid_choices</span><span class="op">$</span><span class="va">choice</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">bias_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">valid_choices</span><span class="op">$</span><span class="va">choice</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">valid_choices</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nStatistical Test for Bias:\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Binomial test p-value:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bias_test</span><span class="op">$</span><span class="va">p.value</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"95% CI for upper threshold proportion:"</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bias_test</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bias_test</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"No valid choices to analyze (all trials may have resulted in timeouts).\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="01_introduction_to_random_walks_files/figure-html/visualize_choice_proportions-1.png" width="768" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Statistical Test for Bias:</span></span>
<span><span class="co">## Binomial test p-value: 0 </span></span>
<span><span class="co">## 95% CI for upper threshold proportion: 0.578 - 0.639</span></span></code></pre>
<p>With a positive drift (Œº = 0.05), we expect more choices for the
upper threshold, which represents the ‚Äúcorrect‚Äù or ‚Äúpreferred‚Äù response
in a decision-making context.</p>
</div>
<div class="section level4">
<h4 id="reaction-time-rt-distributions">
<strong>2. Reaction Time (RT) Distributions</strong><a class="anchor" aria-label="anchor" href="#reaction-time-rt-distributions"></a>
</h4>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">valid_choices</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># RT summary statistics</span></span>
<span>  <span class="va">rt_summary</span> <span class="op">&lt;-</span> <span class="va">valid_choices</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">choice_label</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarise</span><span class="op">(</span></span>
<span>      N <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      Mean_RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      Median_RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">rt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      SD_RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">rt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      Min_RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">rt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      Max_RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">rt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">rt_summary</span>, </span>
<span>               caption <span class="op">=</span> <span class="st">"Summary Statistics for RTs by Choice Outcome"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create RT distribution plots</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">valid_choices</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">choice_label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">choice_label</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tomato"</span>, <span class="st">"lightblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"RT Distributions by Choice Outcome"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Reaction Time (Steps)"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span>,</span>
<span>         fill <span class="op">=</span> <span class="st">"Choice"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Box plot comparison</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">valid_choices</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">choice_label</span>, y <span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">choice_label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span>, width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tomato"</span>, <span class="st">"lightblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"RT Comparison Between Choices"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Choice Outcome"</span>, y <span class="op">=</span> <span class="st">"Reaction Time (Steps)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Density overlay</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">valid_choices</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, color <span class="op">=</span> <span class="va">choice_label</span>, fill <span class="op">=</span> <span class="va">choice_label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkred"</span>, <span class="st">"darkblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tomato"</span>, <span class="st">"lightblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"RT Density Distributions"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Reaction Time (Steps)"</span>, y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>         color <span class="op">=</span> <span class="st">"Choice"</span>, fill <span class="op">=</span> <span class="st">"Choice"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Arrange plots</span></span>
<span>  <span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span>, <span class="fu">arrangeGrob</span><span class="op">(</span><span class="va">p2</span>, <span class="va">p3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Statistical comparison</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">valid_choices</span><span class="op">$</span><span class="va">choice</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">rt_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">rt</span> <span class="op">~</span> <span class="va">choice</span>, data <span class="op">=</span> <span class="va">valid_choices</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nRT Comparison Between Choices:\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"t-test p-value:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rt_test</span><span class="op">$</span><span class="va">p.value</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean difference (Upper - Lower):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rt_test</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">rt_test</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"steps\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="01_introduction_to_random_walks_files/figure-html/visualize_rt_distributions-1.png" width="768" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## RT Comparison Between Choices:</span></span>
<span><span class="co">## t-test p-value: 0.959409 </span></span>
<span><span class="co">## Mean difference (Upper - Lower): 0.14 steps</span></span></code></pre>
<p><strong>Key Insights from RT Analysis:</strong> - RT distributions
are typically <strong>positively skewed</strong> (long right tail) -
<strong>Faster RTs</strong> often occur for the choice favored by drift
- <strong>Slower RTs</strong> may indicate more difficult decisions or
unfavorable drift - The <strong>variability</strong> in RTs reflects the
stochastic nature of the process</p>
</div>
<div class="section level4">
<h4 id="speed-accuracy-trade-off">
<strong>3. Speed-Accuracy Trade-off</strong><a class="anchor" aria-label="anchor" href="#speed-accuracy-trade-off"></a>
</h4>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">valid_choices</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Define "correct" responses as upper threshold (since drift is positive)</span></span>
<span>  <span class="va">accuracy_data</span> <span class="op">&lt;-</span> <span class="va">valid_choices</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>      correct <span class="op">=</span> <span class="va">choice</span> <span class="op">==</span> <span class="fl">1</span>,  <span class="co"># Upper threshold is "correct" with positive drift</span></span>
<span>      rt_bin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">rt</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">rt</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                   include.lowest <span class="op">=</span> <span class="cn">TRUE</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fastest"</span>, <span class="st">"Fast"</span>, <span class="st">"Medium"</span>, <span class="st">"Slow"</span>, <span class="st">"Slowest"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate accuracy by RT bins</span></span>
<span>  <span class="va">speed_acc_summary</span> <span class="op">&lt;-</span> <span class="va">accuracy_data</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">rt_bin</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarise</span><span class="op">(</span></span>
<span>      N <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      Accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">correct</span><span class="op">)</span>,</span>
<span>      Mean_RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>      .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rt_bin</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">speed_acc_summary</span>, </span>
<span>               caption <span class="op">=</span> <span class="st">"Speed-Accuracy Analysis: Accuracy by RT Quintiles"</span>,</span>
<span>               digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Visualize speed-accuracy trade-off</span></span>
<span>  <span class="va">p_speed_acc</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">speed_acc_summary</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mean_RT</span>, y <span class="op">=</span> <span class="va">Accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">N</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">percent_format</span><span class="op">(</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Speed-Accuracy Trade-off"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"Relationship between reaction time and decision accuracy"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Mean Reaction Time (Steps)"</span>, </span>
<span>         y <span class="op">=</span> <span class="st">"Accuracy (Proportion Correct)"</span>,</span>
<span>         size <span class="op">=</span> <span class="st">"N Trials"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_speed_acc</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="01_introduction_to_random_walks_files/figure-html/speed_accuracy_analysis-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="parameter-sensitivity-analysis">Parameter Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#parameter-sensitivity-analysis"></a>
</h2>
<p>Let‚Äôs explore how different parameter values affect model
behavior:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define parameter combinations to test</span></span>
<span><span class="va">param_combinations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  drift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  sd_step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate smaller experiments for each combination</span></span>
<span><span class="va">sensitivity_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">param_combinations</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">params</span> <span class="op">&lt;-</span> <span class="va">param_combinations</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu">simulate_random_walk_experiment</span><span class="op">(</span></span>
<span>    n_trials <span class="op">=</span> <span class="fl">200</span>,  <span class="co"># Smaller n for speed</span></span>
<span>    drift <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">drift</span>,</span>
<span>    threshold <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">threshold</span>,</span>
<span>    sd_step <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">sd_step</span>,</span>
<span>    show_progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate summary statistics</span></span>
<span>  <span class="va">valid_trials</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">choice</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">valid_trials</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sensitivity_results</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      drift <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">drift</span>,</span>
<span>      threshold <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">threshold</span>,</span>
<span>      sd_step <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">sd_step</span>,</span>
<span>      prop_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">valid_trials</span><span class="op">$</span><span class="va">choice</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>      mean_rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">valid_trials</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>      prop_valid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">valid_trials</span><span class="op">)</span> <span class="op">/</span> <span class="fl">200</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Combine results</span></span>
<span><span class="va">sensitivity_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">sensitivity_results</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create visualizations</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sensitivity_df</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Choice proportion heatmap</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">sensitivity_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">drift</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">threshold</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">prop_upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_tile</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Noise œÉ ="</span>, <span class="va">sd_step</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_gradient2</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"red"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"blue"</span>, midpoint <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                        labels <span class="op">=</span> <span class="fu">percent_format</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Choice Bias (Proportion Choosing Upper Threshold)"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Drift (Œº)"</span>, y <span class="op">=</span> <span class="st">"Threshold (a)"</span>, fill <span class="op">=</span> <span class="st">"Prop. Upper"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Mean RT heatmap  </span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">sensitivity_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">drift</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">threshold</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">mean_rt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_tile</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Noise œÉ ="</span>, <span class="va">sd_step</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"yellow"</span>, high <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Mean Reaction Time"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Drift (Œº)"</span>, y <span class="op">=</span> <span class="st">"Threshold (a)"</span>, fill <span class="op">=</span> <span class="st">"Mean RT"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="01_introduction_to_random_walks_files/figure-html/parameter_sensitivity-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="summary-and-next-steps">Summary and Next Steps<a class="anchor" aria-label="anchor" href="#summary-and-next-steps"></a>
</h2>
<p>This vignette introduced the fundamental concepts of random walks and
their implementation in R. We‚Äôve covered:</p>
<div class="section level3">
<h3 id="key-concepts-learned">
<strong>Key Concepts Learned:</strong><a class="anchor" aria-label="anchor" href="#key-concepts-learned"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Mathematical foundation</strong> of discrete-time random
walks</li>
<li>
<strong>Parameter effects</strong>: drift, threshold, and noise</li>
<li>
<strong>Simulation methods</strong> for single trials and
experiments<br>
</li>
<li>
<strong>Statistical analysis</strong> of choice proportions and RT
distributions</li>
<li>
<strong>Speed-accuracy trade-offs</strong> in decision making</li>
<li>
<strong>Parameter sensitivity</strong> analysis</li>
</ol>
</div>
<div class="section level3">
<h3 id="important-insights">
<strong>Important Insights:</strong><a class="anchor" aria-label="anchor" href="#important-insights"></a>
</h3>
<ul>
<li>
<strong>Drift</strong> creates bias toward one choice option</li>
<li>
<strong>Threshold</strong> controls the speed-accuracy
trade-off</li>
<li>
<strong>Noise</strong> increases variability in both choices and
RTs</li>
<li>
<strong>RT distributions</strong> are typically positively
skewed</li>
<li>The model exhibits realistic <strong>speed-accuracy
relationships</strong>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="connection-to-cognitive-science">
<strong>Connection to Cognitive Science:</strong><a class="anchor" aria-label="anchor" href="#connection-to-cognitive-science"></a>
</h3>
<p>Random walks provide the foundation for understanding: -
<strong>Evidence accumulation</strong> in perceptual decisions -
<strong>Response time</strong> distributions in choice tasks -
<strong>Confidence</strong> and decision certainty - <strong>Individual
differences</strong> in decision-making strategies</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dogukan Nami Oztas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
