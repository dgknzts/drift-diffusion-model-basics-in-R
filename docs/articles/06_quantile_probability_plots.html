<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Understanding DDM Output with Quantile Probability Plots (QPPs) • DDM_Basics_R</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Understanding DDM Output with Quantile Probability Plots (QPPs)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DDM_Basics_R</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/shiny_app.html">Interactive Demo</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Understanding DDM Output with Quantile Probability Plots (QPPs)</h1>
                        <h4 data-toc-skip class="author">Dogukan Nami
Oztas</h4>
            
            <h4 data-toc-skip class="date">2025-05-20</h4>
      

      <div class="d-none name"><code>06_quantile_probability_plots.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-beyond-mean-rt-and-accuracy">Introduction: Beyond Mean RT and Accuracy<a class="anchor" aria-label="anchor" href="#introduction-beyond-mean-rt-and-accuracy"></a>
</h2>
<p>When analyzing decision-making data or evaluating models like the
Diffusion Decision Model (DDM), simply looking at mean Reaction Time
(RT) and overall accuracy (Proportion Correct) can hide a wealth of
information. The DDM, for instance, makes precise predictions about the
<strong>entire shape</strong> of the RT distribution for both correct
responses and errors.</p>
<p><strong>Quantile Probability Plots (QPPs)</strong> – also known as
“defective Cumulative Distribution Functions (CDFs)” or sometimes just
“quantile functions” in this context – provide a powerful way to
visualize these full RT distributions alongside choice probabilities.
They allow us to see how different parts of the RT distribution (fast,
medium, slow responses) change across different experimental conditions
or model parameter settings.</p>
<p>This vignette will explain what QPPs are and demonstrate how to
generate and interpret them using data simulated from our DDM functions.
This type of plot is a standard tool in cognitive modeling, exemplified
by figures like Figure 4 in “An Introduction to the Diffusion Model of
Decision-Making” by Smith and Ratcliff.</p>
</div>
<div class="section level2">
<h2 id="what-information-does-a-qpp-convey">What Information Does a QPP Convey?<a class="anchor" aria-label="anchor" href="#what-information-does-a-qpp-convey"></a>
</h2>
<p>A QPP simultaneously displays two key aspects of performance:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Choice Probability:</strong> The likelihood of making a
particular response (e.g., correct vs. error, or choosing option A
vs. option B). This is represented on the
<strong>x-axis</strong>.</p></li>
<li>
<p><strong>RT Distribution Shape:</strong> Instead of just the mean
RT, QPPs show the <strong>density</strong> of the RT distribution for
each response type. The density shows how likely different RTs are,
with:</p>
<ul>
<li>Higher density = more common RTs</li>
<li>Lower density = less common RTs</li>
<li>The width of the distribution shows the variability in RTs</li>
</ul>
</li>
</ol>
<p>These RT densities are plotted on the <strong>y-axis</strong> as
ridges, with: - Correct responses shown in blue - Error responses shown
in red - Median RTs marked with points</p>
</div>
<div class="section level2">
<h2 id="generating-a-ridge-qpp-for-a-single-condition">Generating a Ridge QPP for a Single Condition<a class="anchor" aria-label="anchor" href="#generating-a-ridge-qpp-for-a-single-condition"></a>
</h2>
<p>Let’s first simulate data for a single DDM condition and visualize
its QPP using plot_qpp() to understand the basic output.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define parameters for a single condition</span></span>
<span><span class="va">single_cond_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  mean_v <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  a <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  mean_z <span class="op">=</span> <span class="fl">0.35</span>, <span class="co"># Unbiased</span></span>
<span>  s <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  mean_ter <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  sv <span class="op">=</span> <span class="fl">0.3</span>,     <span class="co"># Some across-trial variability</span></span>
<span>  sz <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  st0 <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="op">)</span></span>
<span><span class="va">n_trials_single_qpp</span> <span class="op">&lt;-</span> <span class="fl">300</span> <span class="co"># Number of trials</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">701</span><span class="op">)</span> <span class="co"># For reproducibility</span></span>
<span><span class="va">data_single_condition_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">simulate_diffusion_experiment_variable</span>,</span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_trials <span class="op">=</span> <span class="va">n_trials_single_qpp</span><span class="op">)</span>, <span class="va">single_cond_params</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clean the data by removing rows where rt or choice is NA (e.g., from timeouts)</span></span>
<span><span class="va">data_single_condition</span> <span class="op">&lt;-</span> <span class="va">data_single_condition_raw</span><span class="op">[</span></span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">data_single_condition_raw</span><span class="op">$</span><span class="va">rt</span>, </span>
<span>                                           <span class="va">data_single_condition_raw</span><span class="op">$</span><span class="va">choice</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Create a named list (even for one condition) for the plotting function</span></span>
<span><span class="va">qpp_single_data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Example Condition"</span> <span class="op">=</span> <span class="va">data_single_condition</span><span class="op">)</span> <span class="co"># More descriptive name</span></span>
<span></span>
<span><span class="co"># Diagnostic checks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of trials simulated:"</span>, <span class="va">n_trials_single_qpp</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Number of trials simulated: 300</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of valid trials after cleaning (no NA rt/choice):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_single_condition</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Number of valid trials after cleaning (no NA rt/choice): 286</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_single_condition</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Proportion of choice=1 (Correct, if upper boundary):"</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data_single_condition</span><span class="op">$</span><span class="va">choice</span> <span class="op">==</span> <span class="fl">1</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Proportion of choice=0 (Error, if lower boundary):"</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data_single_condition</span><span class="op">$</span><span class="va">choice</span> <span class="op">==</span> <span class="fl">0</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"RT range for valid trials:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">data_single_condition</span><span class="op">$</span><span class="va">rt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">" to "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"No valid trials remain after cleaning.\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## Proportion of choice=1 (Correct, if upper boundary): 0.738 </span></span>
<span><span class="co">## Proportion of choice=0 (Error, if lower boundary): 0.262 </span></span>
<span><span class="co">## RT range for valid trials: 0.352 to 5.03</span></span></code></pre>
<p>Now, let’s create a QPP for this single condition. We’ll use our
<code>plot_qpp</code> function to create a plot showing the density of
RTs for both correct and error responses:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">single_qpp_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_qpp</span><span class="op">(</span></span>
<span>  data_list <span class="op">=</span> <span class="va">qpp_single_data_list</span>, <span class="co"># Use the list (even if it has only one item)</span></span>
<span>  plot_title <span class="op">=</span> <span class="st">"QPP: RT Density with Filled Quartile Regions"</span>,</span>
<span>  num_quantiles_fill <span class="op">=</span> <span class="fl">5</span>, <span class="co"># For Quartiles (0-Q1, Q1-M, M-Q3, Q3-Max)</span></span>
<span>  ridge_scale <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  alpha_quantile_fill <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  rt_lim <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Let the plot auto-determine RT limits for this example</span></span>
<span>  show_median_line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  median_line_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  vertical_label_offset <span class="op">=</span> <span class="fl">2</span> <span class="co"># Tune this offset</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">single_qpp_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_quantile_probability_plots_files/figure-html/single_condition_qpp-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="interpreting-the-single-condition-ridge-qpp">Interpreting the Single-Condition Ridge QPP<a class="anchor" aria-label="anchor" href="#interpreting-the-single-condition-ridge-qpp"></a>
</h2>
<p>The plot generated above displays the DDM’s predictions for our
“Example Condition” in a rich format. Let’s break down how to read
it:</p>
<ul>
<li><p><strong>Facet (“Cond 1” or “Example Condition”):</strong> Since
we only provided one condition, there’s only one panel (facet) shown,
labeled with the condition name. If we had multiple conditions in our
data_list, each would appear in its own facet here.</p></li>
<li><p><strong>Vertical Axis (“Reaction Time (s)”):</strong> This axis
represents the reaction time, with faster responses at the bottom and
slower responses at the top.</p></li>
<li>
<p><strong>Horizontal Axis (“Response Probability”):</strong> This
axis shows the probability of a particular response type (Error or
Correct) occurring.</p>
<ul>
<li>The density ridges are positioned horizontally according to their
overall probability. For example, if “Correct” responses occurred 80% of
the time, the “Correct” ridge will be centered around the 80% mark on
this axis. If “Error” responses occurred 20% of the time, the “Error”
ridge will be centered around the 20% mark.</li>
</ul>
</li>
<li>
<p><strong>Density Ridges:</strong></p>
<ul>
<li><p>There are two density ridges shown, one for “Error” responses and
one for “Correct” responses (as indicated by the text labels and
typically differentiated by fill color if fill = response_type was used
in an earlier version, or here, by the quantile fills).</p></li>
<li>
<p>The <strong>shape</strong> of each ridge represents the
probability density of RTs for that response type.</p>
<ul>
<li><p><strong>Wider parts of the ridge</strong> indicate RTs that are
more common or frequent.</p></li>
<li><p><strong>Narrower parts of the ridge</strong> indicate RTs that
are less common.</p></li>
<li><p>The <strong>overall spread</strong> of the ridge along the RT
axis shows the variability in reaction times for that response
type.</p></li>
</ul>
</li>
<li>
<p><strong>Filled Quantile Regions:</strong> Each ridge is
internally colored into distinct bands. If num_quantiles_fill = 5 (as in
your plot legend example), these bands represent quintiles of the RT
distribution:</p>
<ul>
<li><p>The <strong>bottom-most band (e.g., purple, labeled ‘1’)</strong>
covers the fastest 20% of RTs for that response type.</p></li>
<li><p>The <strong>next band up (e.g., dark blue, labeled ‘2’)</strong>
covers RTs from the 20th to the 40th percentile.</p></li>
<li><p>And so on, with the <strong>top-most band (e.g., yellow, labeled
‘5’)</strong> covering the slowest 20% of RTs (80th to 100th
percentile).</p></li>
<li><p>The colors allow you to visually assess how much of the
probability mass falls into different speed segments of the RT
distribution.</p></li>
</ul>
</li>
<li><p><strong>Median Line:</strong> The black horizontal line drawn
across each ridge (if show_median_line = TRUE) indicates the
<strong>median RT</strong> (50th percentile) for that specific response
type (Correct or Error).</p></li>
</ul>
</li>
</ul>
<p><strong>What to Look For in This Single Condition Plot:</strong></p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Choice Probability:</strong></p>
<ul>
<li>Where are the “Correct” and “Error” ridges positioned horizontally?
This directly shows you the P(Correct) and P(Error) for this set of DDM
parameters. In your example image, P(Error) is around 25-30%, and
P(Correct) is around 75-80%.</li>
</ul>
</li>
<li>
<p><strong>RT Distribution Shape for Corrects
vs. Errors:</strong></p>
<ul>
<li><p>Are both distributions similarly shaped, or is one more skewed
than the other?</p></li>
<li><p>Where are the medians? Are errors typically faster or slower than
corrects for this condition?</p></li>
<li><p>How spread out are the RTs for corrects versus errors? (Look at
the total vertical extent of each ridge).</p></li>
</ul>
</li>
<li>
<p><strong>Skewness (from Quantile Fills):</strong></p>
<ul>
<li>For a right-skewed distribution (common in RT data), the upper
quantile regions (e.g., the 80th-100th percentile band) will often
appear visually “longer” or more stretched out along the RT axis than
the lower quantile regions. This indicates a longer tail of slow
responses. Your “Correct” responses in the example plot show this clear
right skew. The “Error” responses also show some right skew.</li>
</ul>
</li>
</ol>
<p>This single plot already provides a much richer picture than just
mean RT and accuracy. It tells us about the likelihood of each choice
and the full distribution of times taken to make those choices.</p>
</div>
<div class="section level2">
<h2 id="generating-and-interpreting-qpps-for-multiple-conditions">Generating and Interpreting QPPs for Multiple Conditions<a class="anchor" aria-label="anchor" href="#generating-and-interpreting-qpps-for-multiple-conditions"></a>
</h2>
<p>The real power of QPPs often comes when comparing multiple
experimental conditions. Let’s simulate data for a few conditions where
we vary the <strong>mean drift rate (mean_v)</strong>, representing
different levels of stimulus difficulty, similar to our earlier vignette
examples. We’ll use the same plot_qpp function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Re-using qpp_base_params from the previous vignette (or define similar ones)</span></span>
<span><span class="co"># Ensure it has sv, sz, st0 defined as our plot_qpp calls simulate_diffusion_experiment_variable</span></span>
<span><span class="va">qpp_multi_cond_base_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  mean_z <span class="op">=</span> <span class="fl">0.3</span>, <span class="co"># Unbiased</span></span>
<span>  s <span class="op">=</span> <span class="fl">0.25</span>,      <span class="co"># Lower s for clearer v effect</span></span>
<span>  mean_ter <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  sv <span class="op">=</span> <span class="fl">0.25</span>,     <span class="co"># Moderate sv</span></span>
<span>  sz <span class="op">=</span> <span class="fl">0.1</span>,     <span class="co"># Moderate sz</span></span>
<span>  st0 <span class="op">=</span> <span class="fl">0.05</span>,   <span class="co"># Moderate st0</span></span>
<span>  dt <span class="op">=</span> <span class="fl">0.001</span></span>
<span><span class="op">)</span></span>
<span><span class="va">n_trials_qpp_multi</span> <span class="op">&lt;-</span> <span class="fl">500</span> <span class="co"># Good number of trials per condition</span></span>
<span></span>
<span><span class="co"># Condition 1: Low drift rate (hard task)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">801</span><span class="op">)</span></span>
<span><span class="va">data_v_low_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">simulate_diffusion_experiment_variable</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_trials <span class="op">=</span> <span class="va">n_trials_qpp_multi</span>, mean_v <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>, <span class="va">qpp_multi_cond_base_params</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Condition 2: Medium drift rate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">802</span><span class="op">)</span></span>
<span><span class="va">data_v_medium_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">simulate_diffusion_experiment_variable</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_trials <span class="op">=</span> <span class="va">n_trials_qpp_multi</span>, mean_v <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span>, <span class="va">qpp_multi_cond_base_params</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Condition 3: High drift rate (easy task)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">803</span><span class="op">)</span></span>
<span><span class="va">data_v_high_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">simulate_diffusion_experiment_variable</span>,</span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_trials <span class="op">=</span> <span class="va">n_trials_qpp_multi</span>, mean_v <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>, <span class="va">qpp_multi_cond_base_params</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a named list for the plotting function</span></span>
<span><span class="va">qpp_multi_data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Hard (v=0.05)"</span> <span class="op">=</span> <span class="va">data_v_low_multi</span>,</span>
<span>  <span class="st">"Medium (v=0.15)"</span> <span class="op">=</span> <span class="va">data_v_medium_multi</span>,</span>
<span>  <span class="st">"Easy (v=0.3)"</span> <span class="op">=</span> <span class="va">data_v_high_multi</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s plot these conditions together. Each condition will appear
in its own facet.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note: Using condition_numbers = FALSE to use the descriptive names from the list</span></span>
<span><span class="va">multi_condition_qpp_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_qpp</span><span class="op">(</span></span>
<span>  data_list <span class="op">=</span> <span class="va">qpp_multi_data_list</span>,</span>
<span>  correct_choice_value <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  error_choice_value <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="st">"QPP: Effect of Stimulus Difficulty (Varying Drift Rate)"</span>,</span>
<span>  num_quantiles_fill <span class="op">=</span> <span class="fl">5</span>, <span class="co"># e.g., Quintiles</span></span>
<span>  ridge_scale <span class="op">=</span> <span class="fl">0.7</span>,      <span class="co"># Adjust for visual appearance with multiple facets</span></span>
<span>  alpha_quantile_fill <span class="op">=</span> <span class="fl">0.65</span>,</span>
<span>  rt_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">3.0</span><span class="op">)</span>,     <span class="co"># Set a common RT limit for comparison, adjust as needed</span></span>
<span>  show_median_line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  median_line_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  condition_numbers <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># Use names from data_list</span></span>
<span>  text_label_offset_factor <span class="op">=</span> <span class="fl">0.05</span> <span class="co"># May need tuning with ridge_scale</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">multi_condition_qpp_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_quantile_probability_plots_files/figure-html/multiple_conditions_qpp_plot-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="interpreting-the-multi-condition-qpp">Interpreting the Multi-Condition QPP<a class="anchor" aria-label="anchor" href="#interpreting-the-multi-condition-qpp"></a>
</h2>
<p>This plot now shows three panels (facets), one for each difficulty
condition (“Hard”, “Medium”, “Easy”). Within each panel, we see the
“Error” and “Correct” RT density ridges.</p>
<p><strong>Key Observations When Comparing Conditions (Effect of
increasing mean_v):</strong></p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Shift in Choice Probabilities:</strong></p>
<ul>
<li>
<p>As you move from the “Hard (v=0.05)” facet to the “Easy (v=0.25)”
facet:</p>
<ul>
<li><p>The “Correct” ridge shifts further to the <strong>right</strong>
along the “Response Probability” axis (P(Correct) increases towards
100%).</p></li>
<li><p>The “Error” ridge shifts further to the <strong>left</strong>
(P(Error) decreases towards 0%).</p></li>
</ul>
</li>
<li><p>This clearly visualizes that increasing stimulus difficulty
(lower mean_v) leads to lower accuracy, and vice-versa.</p></li>
</ul>
</li>
<li>
<p><strong>Shift in RT Distributions:</strong></p>
<ul>
<li><p>For <strong>Correct Responses</strong>: As mean_v increases (task
gets easier), the entire “Correct” density ridge (including its median
and all its quantile regions) tends to shift <strong>downwards</strong>
along the “Reaction Time” axis. This indicates that correct responses
become faster across the board.</p></li>
<li>
<p>For <strong>Error Responses</strong>: The pattern for error RTs
can be more complex and depends on other parameters (like sv).</p>
<ul>
<li><p>If sv is substantial, errors in easy conditions (high mean_v)
might be very fast (if z is biased or sz allows starting near the wrong
boundary) or very slow (if v_trial happened to be very low or
negative).</p></li>
<li><p>In general, with increasing mean_v, if errors still occur, they
might also become faster, or their distribution might change shape. The
QPP allows you to inspect this.</p></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Changes in Distributional Shape/Skew:</strong></p>
<ul>
<li><p>Observe how the spread (distance between fastest and slowest
quantile regions) and skewness of the “Correct” and “Error” ridges
change across conditions.</p></li>
<li><p>For very easy conditions (high mean_v), RT distributions might
become less variable and less skewed (more peaked at faster
RTs).</p></li>
<li><p>For harder conditions (low mean_v), the noise s and variability
sv have more opportunity to influence the process, potentially leading
to more spread-out and skewed RT distributions for both correct and
error responses.</p></li>
</ul>
</li>
</ol>
<p><strong>Why QPPs with Facets are Powerful for Multiple
Conditions:</strong></p>
<ul>
<li><p><strong>Direct Comparison:</strong> You can easily compare the
full pattern of choices and RT distributions across your experimental
manipulations.</p></li>
<li><p><strong>Detailed Insights:</strong> They reveal how different
parts of the RT distribution (not just the mean) are affected by changes
in parameters or experimental conditions. For example, a manipulation
might affect slow responses more than fast responses, which a QPP would
show.</p></li>
<li><p><strong>Model Testing:</strong> When fitting models to data,
researchers plot the QPP for their empirical data and overlay the QPP
predicted by their best-fitting DDM parameters. A good match across all
quantiles and choice probabilities indicates a good model fit.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Quantile Probability Plots, especially when visualized with density
ridges and filled quantile regions, offer a rich and comprehensive way
to understand the outputs of the Diffusion Decision Model. They allow
for detailed inspection of choice probabilities and the full shape of RT
distributions for both correct and error responses, and are particularly
powerful for comparing behavior across different experimental conditions
or model parameter settings. The plot_qpp() function in this project
provides a flexible tool for generating these informative visualizations
from your DDM simulations.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dogukan Nami Oztas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
